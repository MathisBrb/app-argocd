# On d√©sactive les initContainers par d√©faut
initContainers: []

# On d√©sactive la cr√©ation de secret par Helm (c'est Vault qui g√®re)
credentials:
  useSecret: false

configuration:
  # ‚ö†Ô∏è CHANGEMENT MAJEUR ICI : C'est maintenant une liste (note le tiret - )
  backupStorageLocation:
    - name: default
      provider: aws  # <--- Le provider est d√©plac√© ICI
      bucket: velero
      config:
        region: minio
        s3ForcePathStyle: true
        s3Url: http://minio.velero.svc:9000
  
  # Pareil pour les snapshots, c'est une liste
  volumeSnapshotLocation:
    - name: default
      provider: aws # <--- Et ICI
      config:
        region: minio

# üëá Configuration Vault (Reste inchang√©e et valide)
podAnnotations:
  vault.hashicorp.com/agent-inject: "true"
  vault.hashicorp.com/role: "velero-role"
  vault.hashicorp.com/agent-inject-secret-cloud: "secret/data/velero"
  vault.hashicorp.com/agent-inject-template-cloud: |
    {{- with secret "secret/data/velero" -}}
    {{ .Data.data.cloud }}
    {{- end -}}

# On pointe vers le fichier g√©n√©r√© par Vault
env:
  AWS_SHARED_CREDENTIALS_FILE: /vault/secrets/cloud
